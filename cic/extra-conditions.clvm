(mod (EXTRA_CONDITIONS INNER_PUZZLE inner_solution)

  (defun tweak_solution (EXTRA_CONDITIONS conditions)
    (if EXTRA_CONDITIONS
      (c (f EXTRA_CONDITIONS) (tweak_solution (r EXTRA_CONDITIONS) conditions))
      conditions
    )
  )
 
  (tweak_solution EXTRA_CONDITIONS (a INNER_PUZZLE inner_solution))
)